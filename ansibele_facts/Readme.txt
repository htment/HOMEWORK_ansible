
Объяснения изменений:

1. gather_facts: true:  Добавлена эта строка в плейбук.  Она необходима для того, чтобы Ansible собрал информацию о хосте (факты), включая имя хоста (ansible_hostname) и IP-адрес (ansible_default_ipv4.address).  Без этого переменные ansible_hostname и ansible_default_ipv4.address будут пустыми.

2. motd_message как многострочный литерал:  Переменная motd_message теперь определена как многострочный литерал (с помощью |). Это улучшает читаемость и позволяет легко добавлять несколько строк в приветствие.

3. Использование фактов:  В переменную motd_message добавлены {{ ansible_hostname }} и {{ ansible_default_ipv4.address }}, которые подставляют соответствующие значения из фактов, собранных Ansible.

Вывод выполнения (Пример):

Вывод будет зависеть от вашего окружения (конкретного хоста).  Ниже приведен пример вывода, который вы можете ожидать:

PLAY [all] ⒷⒷⒷⒷⒷⒷⒷⒷⒷⒷⒷⒷⒷⒷⒷⒷⒷⒷⒷⒷⒷⒷⒷⒷⒷⒷⒷⒷⒷⒷⒷⒷⒷⒷ*

TASK [Gathering Facts] ⒷⒷⒷⒷⒷⒷⒷⒷⒷⒷⒷⒷⒷⒷⒷⒷⒷⒷⒷⒷⒷⒷⒷⒷⒷⒷⒷⒷ*
ok: [localhost]

TASK [Set custom MOTD message] ⒷⒷⒷⒷⒷⒷⒷⒷⒷⒷⒷⒷⒷⒷⒷⒷⒷⒷⒷⒷⒷⒷⒷⒷ*
changed: [localhost]

PLAY RECAP ⒷⒷⒷⒷⒷⒷⒷⒷⒷⒷⒷⒷⒷⒷⒷⒷⒷⒷⒷⒷⒷⒷⒷⒷⒷⒷⒷⒷⒷⒷⒷⒷⒷⒷ*
localhost                  : ok=2    changed=1    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   


Файл /etc/motd после выполнения:

После выполнения плейбука, файл /etc/motd будет содержать примерно следующее (конкретное содержимое будет зависеть от вашего хоста):

Добро пожаловать на наш сервер!
Сегодня Вт 17 окт 2023 16:34:12 MSK.
Hostname: localhost
IP-адрес: 127.0.0.1
Желаю хорошего дня, системному администратору!



Для выполнения плейбука, сохраните его как ansible-playbook.yml и запустите команду:

ansible-playbook ansible-playbook.yml -i inventory


где inventory - это ваш инвентарный файл Ansible (если он у вас есть, иначе можно и без него, если вы тестируете на локальном хосте).  Если у вас нет инвентарного файла, Ansible по умолчанию будет использовать localhost.  Убедитесь, что у вас установлен Ansible и настроен доступ по SSH к целевому серверу (если он не localhost).

961/12,000